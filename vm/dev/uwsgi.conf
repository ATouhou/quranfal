
#todo: ubuntu 15 is using systemd instead of upstart, switch!
#https://wiki.ubuntu.com/SystemdForUpstartUsers

description "uwsgi tiny instance"

#start on runlevel [2345]
stop on runlevel [06]

respawn

setuid vagrant
setgid vagrant

env PATH=/home/virtualenv/edgleweb/bin
chdir /home/edgleweb

# internet socket / slow but easier to config
#exec uwsgi  --socket 127.0.0.1:8001 \
#            --chdir /home/edgleweb/  \
#            --wsgi-file edgleweb/wsgi.py \
#            --master  \
#            --processes 4 \
#            --threads 2 \
#            --die-on-term \

exec uwsgi  --socket /home/vagrant/edgleweb.sock \
            --chdir /home/edgleweb/  \
            --wsgi-file edgleweb/wsgi.py \
            --master  \
            --processes 4 \
            --threads 2 \
            --die-on-term \
            --chmod-socket=666